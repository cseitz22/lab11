---
title: "Lab 11 - So what if you smoke when pregnant?"
author: "Cat Seitz"
date: "03.16.23"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}

library(tidyverse) 
library(infer)
library(openintro)
library(bootstrap)

```

```{r set-seed}

set.seed(1234)

```

```{r load-data}

data(ncbirths)

```


### Exercise 1

This data set contains 1000 observations of births in North Carolina with 13 variables, including the parents ages, the maturity of the mother (whatever that means), length of pregnancy and classification, weight of baby and classification, weight gained by mother, number of hospital visits pre-birth, baby's gender, whether the mother is white, a smoker, and is married. The ages, weeks, # of visits, and weight variables are numeric. The rest are categorical. As for outliers, it seem a little strange that a pregnant individual wouldn't gain any weight, but given that a fairly large amount of participants in this study report that, I guess it is fine. Other than that, there doesn't seem to be any crazy outliers. 

### Exercise 2

```{r filtered-df}

ncbirths_white <- ncbirths%>%
  filter(whitemom=="white")

```

```{r calc-mean-white-baby}

mean(ncbirths_white$weight)

```

The mean birth weight of our sample of Caucasian babies is 7.25, which is obviously not 7.43. 


### Exercise 3

Not sure what this is asking. But, why couldn't/wouldn't we just do a t-test here? Just to be more accurate?

```{r t-test}

t.test(ncbirths_white$weight, mu=7.43)

```


### Exercise 4




```{r boots}

boot_df<-ncbirths_white %>%
  specify(response=weight) %>%
  generate(rep=1000, type="bootstrap") %>%
  calculate(stat="mean")
```

```{r plot-boot-weight}

ggplot(data = boot_df, mapping = aes(x = stat)) +
  geom_histogram(binwidth = .01) +
  labs(title = "Bootstrap distribution of means")+
  geom_vline(xintercept = 7.145508,color = "lightblue", linewidth=2)+
  geom_vline(xintercept = 7.352768,color = "lightblue", linewidth=2)

```

```{r conf-interval-weight}

boot_df %>%
  summarize(lower = quantile(stat, 0.025),
            upper = quantile(stat, 0.975))

```


```{r add-column-shifting-means}

boot_df<- boot_df%>%
  mutate(shift=stat+.180862)

```


```{r t-test-2-columns}

t.test(boot_df$stat, boot_df$shift, paired=FALSE, var.equal=TRUE)

```










